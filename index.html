<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<title>Painel Invisível</title>
</head>
<body>

<script>
let popup = null;

// Abre popup
function openPopup() {
    if (!popup || popup.closed) {
        popup = window.open("", "painel", "width=400,height=600");

        if (popup) {
            popup.document.write(`
                <h2>Painel de Controle</h2>
                <button onclick="window.close()">Fechar</button>
            `);
        }
    }
}

// Fecha popup
function closePopup() {
    if (popup && !popup.closed) {
        popup.close();
    }
}

// Listener automático invertido
document.addEventListener("visibilitychange", () => {
    if (document.visibilityState === "hidden") {
        openPopup();   // Saiu da aba → abre
    } else {
        closePopup();  // Voltou → fecha
    }
});
</script>

</body>
</html>